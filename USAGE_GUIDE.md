# SEMåˆæˆå›¾åƒç”Ÿæˆç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è¿™ä¸ªç³»ç»Ÿå®ç°äº†ä½ æå‡ºçš„æ··åˆæ–¹æ¡ˆï¼š**ç”Ÿæˆä¸¤ç§æè´¨çš„å®Œæ•´å›¾ç‰‡ â†’ ç”Ÿæˆéšæœºmask â†’ æŒ‰maskæ›¿æ¢æè´¨**ã€‚

### æ ¸å¿ƒä¼˜åŠ¿

âœ… **è§£è€¦è®¾è®¡**: æè´¨ç”Ÿæˆå’Œç©ºé—´åˆ†å¸ƒå®Œå…¨åˆ†ç¦»  
âœ… **é«˜åº¦å¯æ§**: å¯ä»¥ç²¾ç¡®æ§åˆ¶æè´¨ç±»å‹ã€åˆ†å¸ƒæ¨¡å¼å’Œç”Ÿæˆå‚æ•°  
âœ… **å¤šç§æ–¹æ³•**: é›†æˆNeural Synthesisã€Image Quiltingå’Œæ··åˆæ–¹æ³•  
âœ… **å®Œæ•´æµæ°´çº¿**: ä»patchæ ‡æ³¨åˆ°æœ€ç»ˆç”Ÿæˆçš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ  

## ğŸš€ å¿«é€Ÿå¼€å§‹ (3åˆ†é’Ÿä½“éªŒ)

### 1. ç«‹å³è¿è¡Œæ¼”ç¤º

```bash
python main.py --demo
```

è¿™ä¼šï¼š
- è‡ªåŠ¨ä»ä½ çš„SEMæ ·æœ¬å›¾åƒæå–patches
- ç”Ÿæˆ5å¼ 256x256çš„åˆæˆå›¾åƒ
- åˆ›å»ºå¯¹åº”çš„æè´¨åˆ†å¸ƒmask
- ä¿å­˜æ‰€æœ‰ç»“æœåˆ° `demo_output/` ç›®å½•

### 2. æŸ¥çœ‹ç»“æœ

```bash
python visualize_results.py
```

## ğŸ“‹ å®Œæ•´å·¥ä½œæµç¨‹

### æ­¥éª¤1: æ ‡æ³¨çº¹ç†Patches

```bash
python main.py --annotate
```

**æ“ä½œè¯´æ˜ï¼š**
1. ç‚¹å‡» "Load Image" é€‰æ‹©SEMå‚è€ƒå›¾åƒ
2. ç”¨é¼ æ ‡æ‹–æ‹½æ¡†é€‰æ„Ÿå…´è¶£çš„çº¹ç†åŒºåŸŸ
3. å¯ä»¥é€‰æ‹©å¤šä¸ªpatchesï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç¼–å·
4. ç‚¹å‡» "Save Patches" ä¿å­˜
5. å¦‚éœ€æ ‡æ³¨å¤šç§æè´¨ï¼Œå¯åŠ è½½ä¸åŒå›¾åƒé‡å¤æ“ä½œ

**è¾“å‡ºï¼š** `patches/å›¾åƒåç§°/` ç›®å½•åŒ…å«æ‰€æœ‰æ ‡æ³¨çš„patches

### æ­¥éª¤2: ç”Ÿæˆåˆæˆæ•°æ®é›†

```bash
# åŸºç¡€ç”Ÿæˆ (æ¨è)
python main.py --generate --count 20 --method mixed

# é«˜è´¨é‡ç”Ÿæˆ
python main.py --generate --count 50 --size 1024 --method neural --device cuda

# å¿«é€ŸéªŒè¯
python main.py --generate --count 5 --method quilting --size 256
```

## ğŸ¨ æ–¹æ³•å¯¹æ¯”ä¸é€‰æ‹©

| æ–¹æ³• | é€Ÿåº¦ | è´¨é‡ | çœŸå®åº¦ | é€‚ç”¨åœºæ™¯ |
|------|------|------|--------|----------|
| **quilting** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | å¿«é€ŸåŸå‹ã€éªŒè¯æ•ˆæœ |
| **neural** | â­â­ | â­â­â­â­â­ | â­â­â­â­ | è¿½æ±‚æœ€ä½³è§†è§‰æ•ˆæœ |
| **mixed** | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | **å¹³è¡¡æ–¹æ¡ˆï¼Œæ¨è** |

### æ–¹æ³•è¯¦è§£

**ğŸ”¹ Image Quilting**
- ç›´æ¥æ‹¼æ¥çœŸå®patches
- ä¿æŒåŸå§‹çº¹ç†ç»†èŠ‚
- é€Ÿåº¦æœ€å¿« (å‡ åˆ†é’Ÿ)
- é€‚åˆï¼šå¿«é€ŸéªŒè¯ã€å¤§æ‰¹é‡ç”Ÿæˆ

**ğŸ”¹ Neural Texture Synthesis**
- åŸºäºVGGç‰¹å¾çš„æ·±åº¦å­¦ä¹ 
- èƒ½ç”Ÿæˆå…¨æ–°çš„çº¹ç†å˜åŒ–
- è´¨é‡æœ€é«˜ä½†é€Ÿåº¦è¾ƒæ…¢ (10-30åˆ†é’Ÿ)
- é€‚åˆï¼šè¿½æ±‚æœ€ä½³æ•ˆæœã€ç ”ç©¶ç”¨é€”

**ğŸ”¹ Mixed Method (æ¨è)**
- ç»“åˆä¸¤ç§æ–¹æ³•çš„ä¼˜åŠ¿
- Neuralä½œä¸ºåŸºç¡€ + Quiltingå¢å¼ºç»†èŠ‚
- å¹³è¡¡é€Ÿåº¦å’Œè´¨é‡
- é€‚åˆï¼šå¤§å¤šæ•°åº”ç”¨åœºæ™¯

## ğŸ›ï¸ é«˜çº§å‚æ•°è°ƒä¼˜

### Maskç±»å‹é€‰æ‹©

```bash
# åœ°è´¨ææ–™æ ·æœ¬ - ä½¿ç”¨å±‚çŠ¶å’Œåˆ†å½¢mask
python main.py --generate --mask-types layered fractal

# å¤šå­”ææ–™ - ä½¿ç”¨ç»†èƒè‡ªåŠ¨æœºå’Œblob
python main.py --generate --mask-types cellular blob

# å¤åˆææ–™ - ä½¿ç”¨voronoiå’Œç½‘ç»œçŠ¶
python main.py --generate --mask-types voronoi network
```

### ç”Ÿæˆè´¨é‡æ§åˆ¶

```bash
# é«˜è´¨é‡è®¾ç½®
python main.py --generate \
  --count 100 \
  --size 1024 \
  --method mixed \
  --device cuda \
  --seed 42      # å¯å¤ç°ç»“æœ

# å…³é—­SEMç‰¹æ•ˆ (è·å¾—"å¹²å‡€"çš„åˆæˆå›¾)
python main.py --generate --no-effects
```

## ğŸ“Š è¾“å‡ºæ–‡ä»¶è¯´æ˜

```
generated_sem/                    # ä¸»è¾“å‡ºç›®å½•
â”œâ”€â”€ material_1/                   # æè´¨1ç”Ÿæˆè¿‡ç¨‹
â”‚   â”œâ”€â”€ texture_material_1.png    # æœ€ç»ˆæè´¨çº¹ç†
â”‚   â”œâ”€â”€ neural_base.png          # Neural synthesisåŸºç¡€
â”‚   â”œâ”€â”€ quilting_detail.png      # Quiltingç»†èŠ‚å±‚
â”‚   â””â”€â”€ mixed_result.png         # æ··åˆç»“æœ
â”œâ”€â”€ material_2/                   # æè´¨2ç”Ÿæˆè¿‡ç¨‹
â”œâ”€â”€ masks/                        # æ‰€æœ‰ç”Ÿæˆçš„mask
â”‚   â”œâ”€â”€ mask_000_perlin.png      # å„ç§ç±»å‹çš„mask
â”‚   â”œâ”€â”€ mask_001_voronoi.png
â”‚   â””â”€â”€ ...
â””â”€â”€ dataset/                      # æœ€ç»ˆåˆæˆæ•°æ®é›†
    â”œâ”€â”€ sem_synthetic_000.png     # åˆæˆSEMå›¾åƒ
    â”œâ”€â”€ mask_000.png              # å¯¹åº”æè´¨åˆ†å¸ƒ
    â”œâ”€â”€ generation_metadata.json  # ç”Ÿæˆå‚æ•°è®°å½•
    â””â”€â”€ ...
```

## ğŸ”§ è‡ªå®šä¹‰ä¸æ‰©å±•

### è°ƒæ•´æè´¨ç”Ÿæˆå‚æ•°

ç¼–è¾‘ `src/texture_synthesizer.py`:

```python
# å¢åŠ Neural Synthesisè¿­ä»£æ¬¡æ•° (æé«˜è´¨é‡)
num_iterations=2000

# è°ƒæ•´ç‰¹å¾å±‚æƒé‡
layer_weights = {
    'conv1_1': 1.0,    # ç»†èŠ‚ç‰¹å¾
    'conv2_1': 1.0,    # ä¸­ç­‰ç‰¹å¾  
    'conv3_1': 1.0,    # é«˜çº§ç‰¹å¾
    'conv4_1': 0.5,    # å‡å°‘é«˜çº§ç‰¹å¾å½±å“
    'conv5_1': 0.5
}
```

### è°ƒæ•´Maskç”Ÿæˆå‚æ•°

ç¼–è¾‘ `src/mask_generator.py`:

```python
# æ§åˆ¶æè´¨æ¯”ä¾‹
target_ratio=0.3  # 30%çš„åŒºåŸŸä¸ºæè´¨2

# è°ƒæ•´Perlinå™ªå£°å°ºåº¦
scale=50         # æ›´å°çš„å€¼ = æ›´ç»†çš„çº¹ç†
threshold=0.4    # æ›´ä½çš„å€¼ = æ›´å¤šæè´¨2åŒºåŸŸ
```

### æ·»åŠ è‡ªå®šä¹‰SEMæ•ˆæœ

ç¼–è¾‘ `src/sem_generator.py`:

```python
def add_custom_sem_effects(self, image):
    # æ·»åŠ ç”µå­æŸæ‰«æçº¿æ•ˆæœ
    # æ·»åŠ å……ç”µæ•ˆåº”
    # æ·»åŠ æ™¯æ·±æ¨¡ç³Š
    # ç­‰ç­‰...
```

## ğŸ¯ åº”ç”¨åœºæ™¯ç¤ºä¾‹

### 1. æ·±åº¦å­¦ä¹ æ¨¡å‹éªŒè¯

```bash
# ç”Ÿæˆå¤§é‡æ ‡æ³¨æ•°æ®ç”¨äºè®­ç»ƒ
python main.py --generate --count 1000 --size 512 --method mixed

# ç”Ÿæˆç‰¹å®šæè´¨åˆ†å¸ƒçš„æµ‹è¯•é›†
python main.py --generate --count 100 --mask-types layered --seed 42
```

### 2. ç®—æ³•é²æ£’æ€§æµ‹è¯•

```bash
# ç”Ÿæˆå„ç§å¤æ‚è¾¹ç•Œçš„æµ‹è¯•æ ·æœ¬
python main.py --generate --count 50 --mask-types fractal network cellular

# ç”Ÿæˆä¸åŒå™ªå£°æ°´å¹³çš„æ ·æœ¬
python main.py --generate --count 20  # ç„¶åæ‰‹åŠ¨è°ƒæ•´å™ªå£°å‚æ•°
```

### 3. æè´¨è¯†åˆ«åŸºå‡†æµ‹è¯•

```bash
# ç”Ÿæˆå·²çŸ¥ground truthçš„æµ‹è¯•é›†
python main.py --generate --count 200 --method mixed --seed 123

# ä½¿ç”¨metadata.jsonè·å¾—å‡†ç¡®çš„æè´¨åˆ†å¸ƒä¿¡æ¯
```

## ğŸ› å¸¸è§é—®é¢˜è§£å†³

### Q: ç”Ÿæˆçš„çº¹ç†ä¸å¤ŸçœŸå®
**A:** å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š
- å¢åŠ patchæ•°é‡å’Œå¤šæ ·æ€§
- ä½¿ç”¨mixedæˆ–neuralæ–¹æ³•
- è°ƒæ•´Neural Synthesisè¿­ä»£æ¬¡æ•°

### Q: æè´¨è¾¹ç•Œå¤ªç”Ÿç¡¬
**A:** 
- ç³»ç»Ÿé»˜è®¤æœ‰è¾¹ç•Œå¹³æ»‘å¤„ç†
- å¯è°ƒæ•´ `border_width` å‚æ•°
- å°è¯•ä¸åŒçš„maskç±»å‹

### Q: ç”Ÿæˆé€Ÿåº¦å¤ªæ…¢
**A:**
- ä½¿ç”¨quiltingæ–¹æ³•
- å‡å°å›¾åƒå°ºå¯¸
- å‡å°‘ç”Ÿæˆæ•°é‡
- ä½¿ç”¨GPUåŠ é€Ÿ (`--device cuda`)

### Q: å†…å­˜ä¸è¶³
**A:**
- ä½¿ç”¨CPUæ¨¡å¼ (`--device cpu`)
- å‡å°å›¾åƒå°ºå¯¸
- å‡å°‘Neural Synthesisè¿­ä»£æ¬¡æ•°

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

åœ¨GTX 3090ä¸Šçš„æµ‹è¯•ç»“æœï¼š

| æ–¹æ³• | å›¾åƒå°ºå¯¸ | ç”Ÿæˆæ—¶é—´ | å†…å­˜ä½¿ç”¨ |
|------|----------|----------|----------|
| quilting | 512x512 | ~30ç§’ | ~2GB |
| neural | 512x512 | ~15åˆ†é’Ÿ | ~4GB |
| mixed | 512x512 | ~8åˆ†é’Ÿ | ~4GB |
| quilting | 1024x1024 | ~2åˆ†é’Ÿ | ~4GB |
| neural | 1024x1024 | ~45åˆ†é’Ÿ | ~8GB |

## ğŸ”® è¿›ä¸€æ­¥å‘å±•

### å¯èƒ½çš„æ”¹è¿›æ–¹å‘

1. **æ›´å¤šæè´¨ç±»å‹æ”¯æŒ**
   - æ‰©å±•åˆ°3ç§æˆ–æ›´å¤šæè´¨
   - æ”¯æŒæè´¨æ¸å˜è¿‡æ¸¡

2. **æ™ºèƒ½Patché€‰æ‹©**
   - è‡ªåŠ¨è´¨é‡è¯„ä¼°
   - åŸºäºç›¸ä¼¼åº¦çš„patchèšç±»

3. **é«˜çº§Maskç”Ÿæˆ**
   - åŸºäºç‰©ç†è§„å¾‹çš„åˆ†å¸ƒ
   - ç”¨æˆ·äº¤äº’å¼ç¼–è¾‘

4. **å®æ—¶ç”Ÿæˆ**
   - æ¨¡å‹å‹ç¼©å’Œä¼˜åŒ–
   - è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²

---

ğŸ‰ **æ­å–œï¼ä½ ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„SEMåˆæˆå›¾åƒç”Ÿæˆç³»ç»Ÿï¼**

è¿™ä¸ªç³»ç»ŸæˆåŠŸå®ç°äº†ä½ æå‡ºçš„æ··åˆæ–¹æ¡ˆï¼Œæä¾›äº†çµæ´»å¯æ§çš„æè´¨åˆæˆèƒ½åŠ›ã€‚ä½ å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©ä¸åŒçš„ç”Ÿæˆæ–¹æ³•å’Œå‚æ•°ï¼Œå¿«é€Ÿç”Ÿæˆé«˜è´¨é‡çš„åˆæˆSEMæ•°æ®é›†ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹éªŒè¯ã€‚ 